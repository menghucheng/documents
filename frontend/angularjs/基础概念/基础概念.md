# AngularJS 基础概念

## 1. AngularJS 概述

AngularJS 是一个由 Google 开发的 JavaScript 框架，用于构建单页应用（SPA）。它通过扩展 HTML 语法，使开发者能够更轻松地构建动态、交互式的 Web 应用程序。

AngularJS 的核心思想是将应用程序逻辑与视图分离，使用依赖注入和双向数据绑定等特性，提高代码的可维护性和可测试性。

## 2. AngularJS 的主要特点

### 2.1 双向数据绑定
AngularJS 实现了模型（Model）和视图（View）之间的双向数据绑定，当模型数据发生变化时，视图会自动更新，反之亦然。

```html
<!-- HTML 视图 -->
<div ng-app="myApp" ng-controller="myCtrl">
  <input type="text" ng-model="name">
  <h1>Hello {{name}}</h1>
</div>

<script>
// JavaScript 模型
var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope) {
  $scope.name = "World";
});
</script>
```

### 2.2 MVC 架构
AngularJS 采用 Model-View-Controller（MVC）架构模式，将应用程序分为三个部分：

- **Model**：应用程序的数据和业务逻辑
- **View**：用户界面，展示数据
- **Controller**：连接 Model 和 View，处理用户交互

### 2.3 依赖注入
AngularJS 内置了依赖注入（Dependency Injection）机制，允许开发者将依赖项注入到控制器、服务等组件中，提高代码的可测试性和可维护性。

```javascript
app.controller('myCtrl', function($scope, $http, $timeout) {
  // 使用注入的依赖项
  $http.get('/api/data').then(function(response) {
    $scope.data = response.data;
  });
});
```

### 2.4 指令系统
AngularJS 允许开发者创建自定义指令，扩展 HTML 语法，实现组件化开发。

```javascript
// 自定义指令
app.directive('myDirective', function() {
  return {
    template: '<h2>这是一个自定义指令</h2>'
  };
});

// 使用自定义指令
<div my-directive></div>
```

### 2.5 模块化
AngularJS 支持模块化开发，允许开发者将应用程序拆分为多个模块，提高代码的组织性和可复用性。

```javascript
// 创建模块
var app = angular.module('myApp', []);

// 创建控制器
app.controller('myCtrl', function($scope) {
  // 控制器逻辑
});
```

### 2.6 服务
AngularJS 提供了多种内置服务（如 `$http`、`$timeout`、`$location` 等），同时允许开发者创建自定义服务，实现业务逻辑的复用。

### 2.7 表单验证
AngularJS 提供了强大的表单验证功能，支持内置验证器和自定义验证器。

```html
<form name="myForm">
  <input type="email" name="email" ng-model="user.email" required>
  <span ng-show="myForm.email.$error.required">邮箱是必填项</span>
  <span ng-show="myForm.email.$error.email">请输入有效的邮箱地址</span>
</form>
```

## 3. AngularJS 核心概念

### 3.1 模块（Module）
模块是 AngularJS 应用程序的基本构建块，用于组织代码。每个 AngularJS 应用程序至少有一个模块，通常命名为 `app`。

```javascript
// 创建模块
var app = angular.module('myApp', [/* 依赖的其他模块 */]);

// 使用模块
<div ng-app="myApp">
  <!-- 应用内容 -->
</div>
```

### 3.2 控制器（Controller）
控制器用于定义应用程序的行为，处理用户交互，连接 Model 和 View。

```javascript
app.controller('myCtrl', function($scope) {
  // 初始化数据
  $scope.message = "Hello AngularJS";
  
  // 定义方法
  $scope.greet = function() {
    $scope.message = "Hello " + $scope.name;
  };
});
```

### 3.3 作用域（Scope）
作用域是连接控制器和视图的桥梁，它是一个对象，包含模型数据和方法。

```javascript
app.controller('myCtrl', function($scope) {
  // 向作用域添加属性
  $scope.name = "World";
  
  // 向作用域添加方法
  $scope.sayHello = function() {
    return "Hello " + $scope.name;
  };
});
```

### 3.4 指令（Directive）
指令是 AngularJS 扩展 HTML 的方式，以 `ng-` 前缀开头，如 `ng-app`、`ng-controller`、`ng-model` 等。

| 指令 | 描述 |
|------|------|
| `ng-app` | 定义 AngularJS 应用程序的根元素 |
| `ng-controller` | 定义控制器的作用域 |
| `ng-model` | 将表单控件与模型数据绑定 |
| `ng-repeat` | 遍历数组或对象，生成重复的 HTML 元素 |
| `ng-click` | 绑定点击事件 |
| `ng-show` / `ng-hide` | 根据条件显示或隐藏元素 |
| `ng-if` | 根据条件创建或移除元素 |
| `ng-class` | 动态添加或移除 CSS 类 |
| `ng-style` | 动态添加内联样式 |

### 3.5 服务（Service）
服务是 AngularJS 中可复用的单例对象，用于封装业务逻辑和数据访问。

#### 内置服务

| 服务 | 描述 |
|------|------|
| `$http` | 用于发送 HTTP 请求 |
| `$timeout` | 封装 `setTimeout` |
| `$interval` | 封装 `setInterval` |
| `$location` | 用于处理 URL |
| `$rootScope` | 所有作用域的根作用域 |
| `$routeProvider` | 用于配置路由 |
| `$q` | 用于处理异步操作和 Promise |

#### 自定义服务

```javascript
// 创建自定义服务
app.service('myService', function() {
  this.getData = function() {
    return [
      { id: 1, name: 'Item 1' },
      { id: 2, name: 'Item 2' }
    ];
  };
});

// 使用自定义服务
app.controller('myCtrl', function($scope, myService) {
  $scope.data = myService.getData();
});
```

### 3.6 过滤器（Filter）
过滤器用于格式化数据，在视图中显示之前对数据进行处理。

```html
<!-- 使用内置过滤器 -->
<p>{{ today | date: 'yyyy-MM-dd' }}</p>
<p>{{ price | currency }}</p>
<p>{{ text | uppercase }}</p>
<p>{{ items | filter:searchText }}</p>
```

```javascript
// 创建自定义过滤器
app.filter('reverse', function() {
  return function(text) {
    return text.split('').reverse().join('');
  };
});

// 使用自定义过滤器
<p>{{ text | reverse }}</p>
```

### 3.7 路由（Routing）
AngularJS 的路由模块 `ngRoute` 用于实现单页应用的路由功能，根据 URL 加载不同的视图。

```javascript
// 配置路由
app.config(function($routeProvider) {
  $routeProvider
    .when('/', {
      templateUrl: 'home.html',
      controller: 'homeCtrl'
    })
    .when('/about', {
      templateUrl: 'about.html',
      controller: 'aboutCtrl'
    })
    .otherwise({
      redirectTo: '/'
    });
});
```

## 4. AngularJS 应用程序结构

### 4.1 典型的文件结构

```
my-angular-app/
├── index.html              # 应用入口文件
├── js/
│   ├── app.js              # 主模块定义
│   ├── controllers/        # 控制器
│   │   ├── homeCtrl.js
│   │   └── aboutCtrl.js
│   ├── services/           # 服务
│   │   └── dataService.js
│   ├── directives/         # 指令
│   │   └── myDirective.js
│   └── filters/            # 过滤器
│       └── reverseFilter.js
├── css/
│   └── style.css
└── views/                  # 视图模板
    ├── home.html
    └── about.html
```

### 4.2 应用程序引导

AngularJS 应用程序通过 `ng-app` 指令或 JavaScript 代码引导：

```html
<!-- 通过 ng-app 指令引导 -->
<div ng-app="myApp">
  <!-- 应用内容 -->
</div>
```

```javascript
// 通过 JavaScript 代码引导
angular.element(document).ready(function() {
  angular.bootstrap(document, ['myApp']);
});
```

## 5. AngularJS 与其他框架的比较

| 特性 | AngularJS | React | Vue |
|------|----------|-------|-----|
| 发布时间 | 2010 | 2013 | 2014 |
| 架构模式 | MVC | 组件化 | 组件化 + MVVM |
| 数据绑定 | 双向 | 单向 | 双向/单向 |
| 依赖注入 | 内置 | 第三方库 | 第三方库 |
| 学习曲线 | 较陡 | 中等 | 较平缓 |
| 性能 | 一般 | 优秀 | 优秀 |
| 生态系统 | 成熟 | 庞大 | 快速增长 |

## 6. AngularJS 的优势与劣势

### 6.1 优势

- 双向数据绑定，减少 DOM 操作代码
- MVC 架构，提高代码的可维护性
- 依赖注入，提高代码的可测试性
- 丰富的内置指令和服务
- 强大的表单验证功能
- 成熟的社区和生态系统

### 6.2 劣势

- 性能问题，尤其是在处理大量数据时
- 学习曲线较陡
- 与现代前端开发趋势（如组件化、函数式编程）不完全契合
- AngularJS 1.x 与 Angular 2+ 不兼容，迁移成本高

## 7. 安装与使用

### 7.1 直接引入 CDN

```html
<!DOCTYPE html>
<html>
<head>
  <title>AngularJS 应用</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
</head>
<body>
  <div ng-app="myApp" ng-controller="myCtrl">
    <h1>Hello {{name}}</h1>
  </div>

  <script>
    var app = angular.module('myApp', []);
    app.controller('myCtrl', function($scope) {
      $scope.name = "World";
    });
  </script>
</body>
</html>
```

### 7.2 使用 npm 安装

```bash
npm install angular@1.8.2
```

然后在项目中引入：

```html
<script src="node_modules/angular/angular.min.js"></script>
```

## 8. 总结

AngularJS 是一个功能强大的 JavaScript 框架，用于构建单页应用程序。它的核心特性包括双向数据绑定、MVC 架构、依赖注入、指令系统等，使开发者能够更高效地构建动态、交互式的 Web 应用。

虽然 AngularJS 1.x 已经逐渐被 Angular 2+ 取代，但它仍然是许多现有应用的基础，学习 AngularJS 有助于理解现代前端框架的设计思想和核心概念。

对于新项目，建议考虑使用 Angular 2+、React 或 Vue 等现代前端框架，但对于维护现有 AngularJS 应用，掌握 AngularJS 的核心概念仍然是必要的。