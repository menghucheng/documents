# 微信小程序配置

## 1. 配置文件概述

微信小程序的配置文件主要分为以下几种：

| 配置文件 | 作用 | 位置 |
|---------|------|------|
| app.json | 全局配置，配置小程序的全局属性、页面路径、窗口样式、底部 tab 等 | 项目根目录 |
| project.config.json | 项目配置，配置开发工具的项目设置 | 项目根目录 |
| sitemap.json | 搜索索引配置，控制小程序页面是否允许被微信搜索 | 项目根目录 |
| 页面.json | 页面配置，配置单个页面的窗口样式、导航栏、背景等 | 页面目录下 |
| app.wxss | 全局样式文件，定义全局样式 | 项目根目录 |
| 页面.wxss | 页面样式文件，定义单个页面的样式 | 页面目录下 |

## 2. 全局配置（app.json）

`app.json` 是小程序的全局配置文件，用于配置小程序的全局属性、页面路径、窗口样式、底部 tab 等。

### 2.1 基本结构

```json
{
  "pages": [],
  "window": {},
  "tabBar": {},
  "networkTimeout": {},
  "debug": false,
  "navigateToMiniProgramAppIdList": [],
  "permission": {},
  "sitemapLocation": "sitemap.json"
}
```

### 2.2 常用配置项

#### 2.2.1 pages

用于指定小程序由哪些页面组成，数组中的第一个页面是小程序的首页。

**配置示例**：
```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/logs",
    "pages/user/user"
  ]
}
```

#### 2.2.2 window

用于设置小程序的状态栏、导航栏、标题、窗口背景色等。

**配置示例**：
```json
{
  "window": {
    "navigationBarBackgroundColor": "#ffffff",
    "navigationBarTextStyle": "black",
    "navigationBarTitleText": "微信小程序",
    "backgroundColor": "#ffffff",
    "backgroundTextStyle": "light",
    "enablePullDownRefresh": false,
    "onReachBottomDistance": 50,
    "navigationStyle": "default",
    "disableScroll": false
  }
}
```

**配置项说明**：
- `navigationBarBackgroundColor`：导航栏背景色，如 `#ffffff`
- `navigationBarTextStyle`：导航栏标题颜色，仅支持 `black` / `white`
- `navigationBarTitleText`：导航栏标题文字内容
- `backgroundColor`：窗口的背景色
- `backgroundTextStyle`：下拉 loading 的样式，仅支持 `dark` / `light`
- `enablePullDownRefresh`：是否全局开启下拉刷新
- `onReachBottomDistance`：页面上拉触底事件触发时距页面底部距离，单位为 px
- `navigationStyle`：导航栏样式，仅支持 `default` / `custom`（自定义导航栏）
- `disableScroll`：设置为 `true` 则页面整体不能上下滚动

#### 2.2.3 tabBar

用于配置小程序的底部标签栏，最多支持 5 个标签，最少 2 个标签。

**配置示例**：
```json
{
  "tabBar": {
    "color": "#999999",
    "selectedColor": "#07c160",
    "backgroundColor": "#ffffff",
    "borderStyle": "black",
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "images/home.png",
        "selectedIconPath": "images/home-active.png"
      },
      {
        "pagePath": "pages/category/category",
        "text": "分类",
        "iconPath": "images/category.png",
        "selectedIconPath": "images/category-active.png"
      },
      {
        "pagePath": "pages/cart/cart",
        "text": "购物车",
        "iconPath": "images/cart.png",
        "selectedIconPath": "images/cart-active.png"
      },
      {
        "pagePath": "pages/user/user",
        "text": "我的",
        "iconPath": "images/user.png",
        "selectedIconPath": "images/user-active.png"
      }
    ]
  }
}
```

**配置项说明**：
- `color`：tab 上的文字默认颜色
- `selectedColor`：tab 上的文字选中时的颜色
- `backgroundColor`：tab 的背景色
- `borderStyle`：tabbar 上边框的颜色，仅支持 `black` / `white`
- `list`：tab 的列表，最少 2 个，最多 5 个
  - `pagePath`：页面路径，必须在 pages 中预先定义
  - `text`：tab 上显示的文字
  - `iconPath`：未选中时的图标路径
  - `selectedIconPath`：选中时的图标路径
  - `iconSize`：图标大小，单位为 px（可选）

#### 2.2.4 networkTimeout

用于设置网络请求的超时时间。

**配置示例**：
```json
{
  "networkTimeout": {
    "request": 60000,
    "connectSocket": 60000,
    "uploadFile": 60000,
    "downloadFile": 60000
  }
}
```

**配置项说明**：
- `request`：wx.request 的超时时间，单位 ms
- `connectSocket`：wx.connectSocket 的超时时间，单位 ms
- `uploadFile`：wx.uploadFile 的超时时间，单位 ms
- `downloadFile`：wx.downloadFile 的超时时间，单位 ms

#### 2.2.5 debug

用于设置是否开启调试模式，开发阶段可以设置为 `true`，发布时应设置为 `false`。

**配置示例**：
```json
{
  "debug": true
}
```

#### 2.2.6 permission

用于配置小程序所需的权限。

**配置示例**：
```json
{
  "permission": {
    "scope.userLocation": {
      "desc": "您的位置信息将用于小程序定位"
    },
    "scope.camera": {
      "desc": "您的相机将用于扫描二维码"
    }
  }
}
```

**常用权限列表**：
- `scope.userLocation`：地理位置
- `scope.record`：录音功能
- `scope.camera`：摄像头
- `scope.writePhotosAlbum`：保存到相册
- `scope.userInfo`：用户信息

### 2.3 高级配置

#### 2.3.1 分包加载配置

当小程序代码包大小超过 2MB 时，可以使用分包加载机制，将代码拆分为主包和多个分包。

**配置示例**：
```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/logs"
  ],
  "subpackages": [
    {
      "root": "packageA",
      "name": "packageA",
      "pages": [
        "pages/cat/cat",
        "pages/dog/dog"
      ],
      "independent": false
    },
    {
      "root": "packageB",
      "name": "packageB",
      "pages": [
        "pages/apple/apple",
        "pages/banana/banana"
      ],
      "independent": true
    }
  ],
  "preloadRule": {
    "pages/index/index": {
      "packages": ["packageA"]
    },
    "pages/logs/logs": {
      "packages": ["packageB"]
    }
  }
}
```

**配置项说明**：
- `root`：分包根目录
- `name`：分包名称
- `pages`：分包内的页面列表
- `independent`：分包是否为独立分包，独立分包可以独立运行
- `preloadRule`：预加载规则，指定页面打开时预加载哪些分包

#### 2.3.2 插件配置

用于声明小程序使用的插件。

**配置示例**：
```json
{
  "plugins": {
    "myPlugin": {
      "version": "1.0.0",
      "provider": "wx1234567890abcdef"
    }
  }
}
```

**配置项说明**：
- `version`：插件版本号
- `provider`：插件提供者的 AppID

#### 2.3.3 云开发配置

用于配置云开发环境。

**配置示例**：
```json
{
  "cloud": {
    "env": "production-123456",
    "traceUser": true
  }
}
```

**配置项说明**：
- `env`：云开发环境 ID
- `traceUser`：是否在每个云开发调用中包含用户信息

## 3. 项目配置（project.config.json）

`project.config.json` 是项目配置文件，用于配置开发工具的项目设置，如项目名称、AppID、编译设置等。

### 3.1 基本结构

```json
{
  "description": "项目配置文件",
  "packOptions": {},
  "setting": {},
  "compileType": "miniprogram",
  "libVersion": "2.14.1",
  "appid": "wx1234567890abcdef",
  "projectname": "微信小程序项目",
  "debugOptions": {},
  "isGameTourist