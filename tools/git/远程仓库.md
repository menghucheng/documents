# Git 远程仓库

## 1. 远程仓库概述

远程仓库是存储在远程服务器上的 Git 仓库，用于多人协作和代码备份。常见的远程仓库托管服务包括 GitHub、GitLab、Bitbucket 等。

## 2. 查看远程仓库

### 2.1 `git remote`

查看已配置的远程仓库。

**语法：**
```bash
$ git remote
```

**输出示例：**
```
origin
upstream
```

**常用选项：**
- `-v` 或 `--verbose`：显示远程仓库的 URL

**示例：**
```bash
$ git remote -v
```

**输出示例：**
```
origin  https://github.com/user/repo.git (fetch)
origin  https://github.com/user/repo.git (push)
upstream        https://github.com/original-owner/repo.git (fetch)
upstream        https://github.com/original-owner/repo.git (push)
```

## 3. 添加远程仓库

### 3.1 `git remote add`

添加新的远程仓库。

**语法：**
```bash
$ git remote add <远程仓库名> <远程仓库URL>
```

**示例：**
```bash
$ git remote add origin https://github.com/user/repo.git
```

**常用远程仓库名：**
- `origin`：默认的远程仓库名，通常指向你自己的复刻
- `upstream`：通常指向原始仓库，用于同步更新

## 4. 推送代码

### 4.1 `git push`

将本地仓库的提交推送到远程仓库。

**语法：**
```bash
$ git push <远程仓库名> <分支名>
```

**常用用法：**

1. 推送当前分支到默认远程仓库：
```bash
$ git push
```

2. 推送指定分支到指定远程仓库：
```bash
$ git push origin main
```

3. 推送所有分支到远程仓库：
```bash
$ git push --all origin
```

4. 推送标签到远程仓库：
```bash
$ git push --tags origin
```

5. 推送当前分支并设置 upstream：
```bash
$ git push -u origin feature-branch
```

**常用选项：**
- `-u` 或 `--set-upstream`：设置 upstream 分支，方便后续使用 `git push` 或 `git pull`
- `--force` 或 `-f`：强制推送，覆盖远程仓库的提交（谨慎使用）
- `--delete` 或 `-d`：删除远程分支

**输出示例：**
```
Enumerating objects: 10, done.
Counting objects: 100% (10/10), done.
Delta compression using up to 8 threads
Compressing objects: 100% (6/6), done.
Writing objects: 100% (7/7), 650 bytes | 650.00 KiB/s, done.
Total 7 (delta 3), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (3/3), completed with 3 local objects.
To https://github.com/user/repo.git
   1a2b3c4..5d6e7f8  main -> main
```

## 5. 拉取代码

### 5.1 `git pull`

从远程仓库获取最新代码并合并到当前分支。

**语法：**
```bash
$ git pull <远程仓库名> <分支名>
```

**常用用法：**

1. 从默认远程仓库拉取并合并到当前分支：
```bash
$ git pull
```

2. 从指定远程仓库拉取并合并到当前分支：
```bash
$ git pull origin main
```

3. 拉取但不合并，只更新远程跟踪分支：
```bash
$ git pull --no-merge origin main
```

**常用选项：**
- `--rebase`：使用 rebase 而不是 merge 来整合远程变更
- `--no-commit`：拉取但不自动提交合并结果

**输出示例：**
```
remote: Enumerating objects: 10, done.
remote: Counting objects: 100% (10/10), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 7 (delta 3), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (7/7), 650 bytes | 650.00 KiB/s, done.
From https://github.com/user/repo
   5d6e7f8..7a8b9c0  main       -> origin/main
Updating 5d6e7f8..7a8b9c0
Fast-forward
 README.md | 2 ++
 1 file changed, 2 insertions(+)
```

## 6. 抓取代码

### 6.1 `git fetch`

从远程仓库获取最新代码，但不合并到当前分支。

**语法：**
```bash
$ git fetch <远程仓库名> <分支名>
```

**常用用法：**

1. 从默认远程仓库获取所有分支的更新：
```bash
$ git fetch
```

2. 从指定远程仓库获取指定分支的更新：
```bash
$ git fetch origin main
```

3. 获取所有远程仓库的更新：
```bash
$ git fetch --all
```

**输出示例：**
```
remote: Enumerating objects: 10, done.
remote: Counting objects: 100% (10/10), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 7 (delta 3), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (7/7), 650 bytes | 650.00 KiB/s, done.
From https://github.com/user/repo
   5d6e7f8..7a8b9c0  main       -> origin/main
   4g5h6i7..8j9k0l1  feature-branch -> origin/feature-branch
```

## 7. 克隆远程仓库

### 7.1 `git clone`

从远程仓库复制到本地，创建一个新的本地仓库。

**语法：**
```bash
$ git clone <远程仓库URL> <本地目录名>
```

**示例：**

1. 克隆远程仓库到当前目录：
```bash
$ git clone https://github.com/user/repo.git
```

2. 克隆远程仓库到指定目录：
```bash
$ git clone https://github.com/user/repo.git my-project
```

3. 克隆指定分支：
```bash
$ git clone -b <分支名> <远程仓库URL>
```

**输出示例：**
```
Cloning into 'repo'...
remote: Enumerating objects: 100, done.
remote: Counting objects: 100% (100/100), done.
remote: Compressing objects: 100% (70/70), done.
remote: Total 100 (delta 30), reused 100 (delta 30), pack-reused 0
Receiving objects: 100% (100/100), 10.00 KiB | 1.00 MiB/s, done.
Resolving deltas: 100% (30/30), done.
```

## 8. 同步远程仓库

### 8.1 从 upstream 同步更新

当你复刻了一个仓库，需要从原始仓库（upstream）同步更新时，可以使用以下步骤：

1. 添加 upstream 远程仓库：
```bash
$ git remote add upstream https://github.com/original-owner/repo.git
```

2. 从 upstream 获取更新：
```bash
$ git fetch upstream
```

3. 切换到主分支：
```bash
$ git checkout main
```

4. 合并 upstream 的更新：
```bash
$ git merge upstream/main
```

5. 推送更新到你的远程仓库：
```bash
$ git push origin main
```

## 9. 移除远程仓库

### 9.1 `git remote remove`

移除指定的远程仓库。

**语法：**
```bash
$ git remote remove <远程仓库名>
```

**示例：**
```bash
$ git remote remove upstream
```

### 9.2 `git remote rename`

重命名远程仓库。

**语法：**
```bash
$ git remote rename <旧远程仓库名> <新远程仓库名>
```

**示例：**
```bash
$ git remote rename origin my-origin
```

## 10. 查看远程分支

### 10.1 `git branch -r`

查看远程分支。

**语法：**
```bash
$ git branch -r
```

**输出示例：**
```
  origin/HEAD -> origin/main
  origin/main
  origin/feature-branch
  upstream/main
```

### 10.2 `git branch -a`

查看所有分支，包括本地分支和远程分支。

**语法：**
```bash
$ git branch -a
```

**输出示例：**
```
  feature-branch
* main
  remotes/origin/HEAD -> origin/main
  remotes/origin/main
  remotes/origin/feature-branch
  remotes/upstream/main
```

## 11. 高级远程操作

### 11.1 推送标签

**语法：**
```bash
$ git push <远程仓库名> <标签名>
```

**示例：**
```bash
$ git push origin v1.0.0
```

推送所有标签：
```bash
$ git push origin --tags
```

### 11.2 删除远程分支

**语法：**
```bash
$ git push <远程仓库名> --delete <分支名>
```

**示例：**
```bash
$ git push origin --delete feature-old
```

或使用旧语法：
```bash
$ git push origin :feature-old
```

**输出示例：**
```
To https://github.com/user/repo.git
 - [deleted]         feature-old
```

### 11.3 删除远程标签

**语法：**
```bash
$ git push <远程仓库名> --delete <标签名>
```

**示例：**
```bash
$ git push origin --delete v1.0.0
```

或使用旧语法：
```bash
$ git push origin :refs/tags/v1.0.0
```

**输出示例：**
```
To https://github.com/user/repo.git
 - [deleted]         v1.0.0
```

## 12. 远程仓库最佳实践

1. **使用 SSH 协议**：SSH 协议比 HTTPS 更安全，不需要每次推送都输入密码
2. **定期同步**：定期从 upstream 同步更新，避免代码冲突
3. **合理命名远程仓库**：使用有意义的远程仓库名，如 `origin` 和 `upstream`
4. **保护主分支**：在远程仓库设置主分支保护，防止直接推送
5. **使用 Pull Request**：通过 Pull Request 进行代码审查，确保代码质量
6. **定期清理**：删除不再需要的远程分支和标签
