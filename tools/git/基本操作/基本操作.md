# Git 基本操作

## 1. 查看状态

### 1.1 `git status`

查看当前仓库的状态，包括修改的文件、暂存的文件和未跟踪的文件。

**语法：**
```bash
$ git status
```

**输出示例：**
```
On branch main
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   README.md

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        new-file.txt

no changes added to commit (use "git add" and/or "git commit -a")
```

**常用选项：**
- `-s` 或 `--short`：显示简洁格式
- `-b` 或 `--branch`：显示分支信息

**简洁格式输出：**
```bash
$ git status -s
 M README.md
?? new-file.txt
```

## 2. 添加文件

### 2.1 `git add`

将文件添加到暂存区，准备提交。

**语法：**
```bash
$ git add <文件路径>
```

**常用用法：**

1. 添加单个文件：
```bash
$ git add README.md
```

2. 添加多个文件：
```bash
$ git add file1.txt file2.txt
```

3. 添加所有修改的文件：
```bash
$ git add .
```

4. 添加特定目录下的所有文件：
```bash
$ git add src/
```

5. 添加匹配模式的文件：
```bash
$ git add *.txt
```

**常用选项：**
- `-u` 或 `--update`：仅添加已跟踪的文件，不添加新文件
- `-A` 或 `--all`：添加所有修改的文件，包括新文件和删除的文件
- `-p` 或 `--patch`：交互式添加文件的部分修改

## 3. 提交文件

### 3.1 `git commit`

将暂存区的文件提交到本地仓库。

**语法：**
```bash
$ git commit
```

执行后会打开默认编辑器，让你输入提交信息。

**常用用法：**

1. 带提交信息的提交：
```bash
$ git commit -m "提交信息"
```

2. 提交所有已跟踪的修改文件（跳过暂存区）：
```bash
$ git commit -a -m "提交信息"
```

3. 修改上次提交：
```bash
$ git commit --amend
```

4. 修改上次提交的信息：
```bash
$ git commit --amend -m "新的提交信息"
```

**常用选项：**
- `-m` 或 `--message`：指定提交信息
- `-a` 或 `--all`：自动添加所有已跟踪的修改文件
- `--amend`：修改上次提交
- `-v` 或 `--verbose`：显示提交的详细差异

**输出示例：**
```
[main 1a2b3c4] 添加新功能
 1 file changed, 10 insertions(+)
 create mode 100644 new-file.txt
```

## 4. 查看日志

### 4.1 `git log`

查看提交历史记录。

**语法：**
```bash
$ git log
```

**输出示例：**
```
commit 1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7q8r9s0t
Author: Your Name <your.email@example.com>
Date:   Mon Dec 8 22:00:00 2025 +0800

    添加新功能

commit 0t9s8r7q6p5o4n3m2l1k0j9i8h7g6f5e4d3c2b1a
Author: Your Name <your.email@example.com>
Date:   Mon Dec 8 21:00:00 2025 +0800

    初始化仓库
```

**常用选项：**
- `-n <数量>`：显示最近的 n 个提交
- `--oneline`：显示简洁格式，每个提交占一行
- `--graph`：显示分支合并图
- `--decorate`：显示分支和标签信息
- `--all`：显示所有分支的提交
- `--author=<作者>`：按作者过滤提交
- `--since=<时间>`：显示指定时间之后的提交
- `--until=<时间>`：显示指定时间之前的提交
- `-p` 或 `--patch`：显示每个提交的差异

**常用组合：**
```bash
$ git log --oneline --graph --decorate --all
```

**输出示例：**
```
* 1a2b3c4 (HEAD -> main) 添加新功能
* 0t9s8r7 初始化仓库
```

## 5. 查看差异

### 5.1 `git diff`

查看文件的差异，包括工作目录与暂存区的差异、暂存区与本地仓库的差异等。

**常用用法：**

1. 查看工作目录与暂存区的差异：
```bash
$ git diff
```

2. 查看暂存区与本地仓库的差异：
```bash
$ git diff --staged
```

3. 查看工作目录与本地仓库的差异：
```bash
$ git diff HEAD
```

4. 查看两个提交之间的差异：
```bash
$ git diff commit1 commit2
```

5. 查看两个分支之间的差异：
```bash
$ git diff branch1 branch2
```

**常用选项：**
- `--staged` 或 `--cached`：查看暂存区与本地仓库的差异
- `-p` 或 `--patch`：显示详细差异（默认）
- `--stat`：显示简洁的差异统计
- `--name-only`：仅显示修改的文件名
- `--name-status`：显示修改的文件名和状态

**输出示例：**
```
diff --git a/README.md b/README.md
index 1234567..89abcde 100644
--- a/README.md
+++ b/README.md
@@ -1,3 +1,5 @@
 # My Project
 
-Initial commit
+Initial commit
+
+Added new section
```

## 6. 撤销操作

### 6.1 撤销工作目录的修改

**语法：**
```bash
$ git restore <文件路径>
```

或使用旧命令：
```bash
$ git checkout -- <文件路径>
```

**示例：**
```bash
$ git restore README.md
```

### 6.2 撤销暂存区的修改

**语法：**
```bash
$ git restore --staged <文件路径>
```

或使用旧命令：
```bash
$ git reset HEAD <文件路径>
```

**示例：**
```bash
$ git restore --staged README.md
```

### 6.3 回退到指定提交

**语法：**
```bash
$ git reset <提交ID>
```

**常用选项：**
- `--soft`：仅回退 HEAD 指针，保留暂存区和工作目录
- `--mixed`：回退 HEAD 指针和暂存区，保留工作目录（默认）
- `--hard`：回退 HEAD 指针、暂存区和工作目录，丢弃所有修改

**示例：**
```bash
$ git reset --hard 0t9s8r7
```

**输出示例：**
```
HEAD is now at 0t9s8r7 初始化仓库
```

## 7. 删除文件

### 7.1 `git rm`

删除文件并从 Git 跟踪中移除。

**语法：**
```bash
$ git rm <文件路径>
```

**常用用法：**

1. 删除文件：
```bash
$ git rm file.txt
```

2. 删除目录：
```bash
$ git rm -r dir/
```

3. 仅从 Git 跟踪中移除文件，保留物理文件：
```bash
$ git rm --cached file.txt
```

**输出示例：**
```
rm 'file.txt'
```

## 8. 重命名文件

### 8.1 `git mv`

重命名文件或移动文件。

**语法：**
```bash
$ git mv <旧文件名> <新文件名>
```

**示例：**
```bash
$ git mv old-name.txt new-name.txt
```

**输出示例：**
```
renamed:    old-name.txt -> new-name.txt
```

## 9. 查看文件历史

### 9.1 `git blame`

查看文件每行的最后修改者和修改时间。

**语法：**
```bash
$ git blame <文件路径>
```

**输出示例：**
```
1a2b3c4d (Your Name 2025-12-08 22:00:00 +0800) # My Project
1a2b3c4d (Your Name 2025-12-08 22:00:00 +0800)
1a2b3c4d (Your Name 2025-12-08 22:00:00 +0800) Initial commit
0t9s8r7q (Your Name 2025-12-08 21:00:00 +0800)
0t9s8r7q (Your Name 2025-12-08 21:00:00 +0800) Added new section
```

## 10. 基本操作工作流

1. 创建或修改文件
2. 使用 `git status` 查看状态
3. 使用 `git add` 将修改添加到暂存区
4. 使用 `git commit` 将修改提交到本地仓库
5. 使用 `git log` 查看提交历史

**示例工作流：**
```bash
# 创建文件
$ echo "Hello Git" > hello.txt

# 查看状态
$ git status

# 添加到暂存区
$ git add hello.txt

# 提交到本地仓库
$ git commit -m "Add hello.txt"

# 查看提交历史
$ git log --oneline
```
