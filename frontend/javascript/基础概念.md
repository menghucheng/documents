# JavaScript 基础概念

## 1. JavaScript 是什么

JavaScript（简称 JS）是一种轻量级、解释型、面向对象的脚本语言。它最初是为网页交互设计的，但现在已广泛应用于服务器端、移动应用、桌面应用等多个领域。

JavaScript 是 Web 开发的三大核心技术之一，与 HTML（结构）和 CSS（样式）一起，用于创建动态、交互式的网页。

## 2. JavaScript 的发展历史

| 年份 | 事件 |
|------|------|
| 1995 | Brendan Eich 在 Netscape 公司创造了 JavaScript（最初名为 Mocha，后改名为 LiveScript，最终命名为 JavaScript） |
| 1997 | ECMAScript 1（ES1）发布，JavaScript 成为标准 |
| 1999 | ECMAScript 3（ES3）发布，成为 JavaScript 的基础版本 |
| 2009 | ECMAScript 5（ES5）发布，引入了 JSON、严格模式等特性 |
| 2015 | ECMAScript 2015（ES6/ES2015）发布，引入了大量新特性 |
| 2016 | ECMAScript 2016（ES7）发布，引入了指数运算符和 Array.prototype.includes |
| 2017 | ECMAScript 2017（ES8）发布，引入了 async/await、Object.values/entries 等 |
| 2018 | ECMAScript 2018（ES9）发布，引入了异步迭代器、Promise.finally 等 |
| 2019 | ECMAScript 2019（ES10）发布，引入了 Array.flat/flatMap、String.trimStart/End 等 |
| 2020 | ECMAScript 2020（ES11）发布，引入了 BigInt、Nullish Coalescing、Optional Chaining 等 |
| 2021 | ECMAScript 2021（ES12）发布，引入了 Logical Assignment Operators、Numeric Separators 等 |
| 2022 | ECMAScript 2022（ES13）发布，引入了 Top-level await、Private Fields 等 |
| 2023 | ECMAScript 2023（ES14）发布，引入了 Array.fromAsync、Change Array by Copy 等 |

## 3. JavaScript 的特点

### 3.1 核心特点

| 特点 | 描述 |
|------|------|
| **解释型语言** | 不需要编译，直接由浏览器或 JavaScript 引擎解释执行 |
| **动态类型** | 变量类型在运行时确定，不需要显式声明 |
| **弱类型** | 类型可以自动转换 |
| **面向对象** | 支持原型继承和 ES6+ 的类继承 |
| **函数式编程** | 支持高阶函数、闭包、箭头函数等 |
| **事件驱动** | 基于事件循环机制，适合处理异步操作 |
| **单线程** | 同一时间只能执行一个任务，避免了多线程并发问题 |
| **跨平台** | 可以在浏览器、Node.js、移动设备等多种环境中运行 |

### 3.2 JavaScript 与 ECMAScript 的关系

- **ECMAScript（ES）**：JavaScript 的标准和规范
- **JavaScript**：ECMAScript 标准的具体实现，还包括 DOM 和 BOM 等浏览器 API
- **DOM（Document Object Model）**：文档对象模型，用于操作网页内容
- **BOM（Browser Object Model）**：浏览器对象模型，用于操作浏览器窗口

## 4. JavaScript 的运行环境

### 4.1 浏览器环境

在浏览器中，JavaScript 主要用于：
- 动态修改网页内容和样式
- 响应用户交互事件
- 发送 AJAX 请求
- 操作浏览器历史记录
- 存储数据（localStorage、sessionStorage、IndexedDB）

浏览器中的 JavaScript 运行在沙箱环境中，具有安全限制：
- 不能直接访问本地文件系统
- 不能跨域访问数据
- 不能执行系统命令

### 4.2 Node.js 环境

Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行时，用于服务器端开发。

Node.js 的特点：
- 支持文件系统操作
- 支持网络编程（TCP、HTTP、WebSocket 等）
- 支持子进程管理
- 支持模块化开发
- 拥有丰富的第三方库（npm 生态）

### 4.3 其他环境

- **Electron**：用于创建跨平台桌面应用
- **React Native**、**Flutter**：用于创建移动应用
- **Deno**：新一代 JavaScript/TypeScript 运行时
- **WebAssembly**：与 JavaScript 配合使用，提高性能

## 5. JavaScript 引擎

JavaScript 引擎是执行 JavaScript 代码的程序或解释器。常见的 JavaScript 引擎：

| 引擎名称 | 开发商 | 使用场景 |
|----------|--------|----------|
| V8 | Google | Chrome、Node.js、Electron |
| SpiderMonkey | Mozilla | Firefox |
| JavaScriptCore | Apple | Safari、React Native |
| Chakra | Microsoft | Edge（旧版） |
| Hermes | Facebook | React Native |

JavaScript 引擎的工作原理：

1. **解析（Parsing）**：将 JavaScript 代码转换为抽象语法树（AST）
2. **编译（Compilation）**：将 AST 转换为字节码（某些引擎直接编译为机器码）
3. **执行（Execution）**：执行字节码或机器码
4. **优化（Optimization）**：在执行过程中进行动态优化

## 6. JavaScript 的基本语法

### 6.1 变量声明

JavaScript 中有三种变量声明方式：

```javascript
// var：函数作用域，存在变量提升
var name = "John";

// let：块级作用域，不存在变量提升
let age = 30;

// const：块级作用域，常量，不能重新赋值
const PI = 3.14159;
```

### 6.2 数据类型

JavaScript 有七种基本数据类型和一种引用数据类型：

| 类型 | 描述 | 示例 |
|------|------|------|
| **Number** | 数字（整数或浮点数） | `42`、`3.14` |
| **String** | 字符串 | `"Hello"`、`'World'` |
| **Boolean** | 布尔值 | `true`、`false` |
| **Null** | 空值 | `null` |
| **Undefined** | 未定义 | `undefined` |
| **Symbol** | 唯一标识符（ES6+） | `Symbol("id")` |
| **BigInt** | 大整数（ES11+） | `123n` |
| **Object** | 引用类型 | `{}`、`[]`、`function(){}` |

### 6.3 运算符

JavaScript 支持多种运算符：

| 类别 | 运算符 |
|------|--------|
| 算术运算符 | `+`、`-`、`*`、`/`、`%`、`**`、`++`、`--` |
| 赋值运算符 | `=`、`+=`、`-=`、`*=`、`/=`、`%=` |
| 比较运算符 | `==`、`===`、`!=`、`!==`、`>`、`<`、`>=`、`<=` |
| 逻辑运算符 | `&&`、`||`、`!` |
| 位运算符 | `&`、`|`、`^`、`~`、`<<`、`>>`、`>>>` |
| 条件运算符 | `condition ? expr1 : expr2` |
| 类型运算符 | `typeof`、`instanceof` |
| 可选链运算符（ES11+） | `?.` |
| 空值合并运算符（ES11+） | `??` |

### 6.4 流程控制

#### 6.4.1 条件语句

```javascript
// if-else
if (condition) {
    // 条件为真时执行
} else if (anotherCondition) {
    // 另一个条件为真时执行
} else {
    // 所有条件为假时执行
}

// switch
switch (value) {
    case 1:
        // 当 value 等于 1 时执行
        break;
    case 2:
        // 当 value 等于 2 时执行
        break;
    default:
        // 当 value 不匹配任何 case 时执行
        break;
}
```

#### 6.4.2 循环语句

```javascript
// for 循环
for (let i = 0; i < 10; i++) {
    // 循环体
}

// for...in 循环（遍历对象属性）
for (let key in object) {
    // 循环体
}

// for...of 循环（遍历可迭代对象）
for (let value of iterable) {
    // 循环体
}

// while 循环
while (condition) {
    // 循环体
}

// do...while 循环
do {
    // 循环体
} while (condition);
```

### 6.5 函数

函数是 JavaScript 中的一等公民，可以作为参数传递，也可以作为返回值。

```javascript
// 函数声明
function add(a, b) {
    return a + b;
}

// 函数表达式
const subtract = function(a, b) {
    return a - b;
};

// 箭头函数（ES6+）
const multiply = (a, b) => a * b;

// 立即执行函数表达式（IIFE）
(function() {
    // 代码立即执行
})();

// 高阶函数
function higherOrderFunction(callback) {
    return callback(10);
}

// 调用高阶函数
higherOrderFunction(function(value) {
    return value * 2;
});
```

## 7. JavaScript 的核心概念

### 7.1 作用域

作用域是变量和函数的可访问范围。JavaScript 中有三种作用域：

1. **全局作用域**：在整个程序中可访问
2. **函数作用域**：在函数内部可访问
3. **块级作用域**：在 `{}` 块内部可访问（ES6+，let/const）

### 7.2 变量提升

变量提升是指变量和函数声明会被提升到其作用域的顶部。

```javascript
// var 声明的变量会被提升
console.log(name); // 输出: undefined
var name = "John";

// 函数声明会被提升
console.log(add(2, 3)); // 输出: 5
function add(a, b) {
    return a + b;
}

// let/const 声明的变量不会被提升
console.log(age); // 抛出 ReferenceError
let age = 30;
```

### 7.3 闭包

闭包是指有权访问另一个函数作用域中变量的函数。

闭包的特点：
- 可以访问外部函数的变量
- 外部函数执行后，其变量仍然可以被内部函数访问
- 可以创建私有变量

```javascript
function createCounter() {
    let count = 0;
    
    return {
        increment: function() {
            count++;
            return count;
        },
        decrement: function() {
            count--;
            return count;
        },
        getCount: function() {
            return count;
        }
    };
}

const counter = createCounter();
console.log(counter.increment()); // 输出: 1
console.log(counter.increment()); // 输出: 2
console.log(counter.decrement()); // 输出: 1
console.log(counter.getCount());  // 输出: 1
```

### 7.4 原型和继承

JavaScript 采用原型继承模型，每个对象都有一个原型对象，继承原型对象的属性和方法。

```javascript
// 构造函数
function Person(name, age) {
    this.name = name;
    this.age = age;
}

// 添加原型方法
Person.prototype.greet = function() {
    return `Hello, my name is ${this.name} and I'm ${this.age} years old.`;
};

// 创建实例
const person = new Person("John", 30);
console.log(person.greet()); // 输出: Hello, my name is John and I'm 30 years old.

// ES6+ 类继承
class Animal {
    constructor(name) {
        this.name = name;
    }
    
    speak() {
        return `${this.name} makes a sound.`;
    }
}

class Dog extends Animal {
    constructor(name) {
        super(name);
    }
    
    speak() {
        return `${this.name} says Woof!`;
    }
}

const dog = new Dog("Buddy");
console.log(dog.speak()); // 输出: Buddy says Woof!
```

### 7.5 事件循环

JavaScript 是单线程的，使用事件循环机制处理异步操作。

事件循环的组成部分：
- **调用栈（Call Stack）**：执行同步代码
- **任务队列（Task Queue）**：存放异步任务的回调函数
- **微任务队列（Microtask Queue）**：存放优先级更高的异步任务，如 Promise、async/await

事件循环的流程：
1. 执行调用栈中的同步代码
2. 执行微任务队列中的所有任务
3. 执行任务队列中的一个任务
4. 重复步骤 2-3，直到所有队列都为空

### 7.6 异步编程

JavaScript 中的异步编程方式：

1. **回调函数**：最基本的异步编程方式
2. **Promise**：ES6 引入，解决回调地狱问题
3. **async/await**：ES8 引入，基于 Promise 的语法糖，使异步代码看起来像同步代码

## 8. JavaScript 与 HTML/CSS 的关系

JavaScript、HTML 和 CSS 是 Web 开发的三大核心技术，它们之间的关系：

| 技术 | 作用 | 示例 |
|------|------|------|
| HTML | 定义网页的结构 | `<h1>标题</h1><p>段落</p>` |
| CSS | 定义网页的样式 | `h1 { color: blue; }` |
| JavaScript | 定义网页的行为和交互 | `document.querySelector('h1').addEventListener('click', function() { alert('Hello!'); });` |

JavaScript 可以：
- 修改 HTML 元素的内容和属性
- 修改 CSS 样式
- 响应用户事件（点击、鼠标移动、键盘输入等）
- 发送 AJAX 请求，获取服务器数据
- 操作浏览器历史记录
- 存储数据

## 9. JavaScript 的模块化

模块化是将代码分解为独立、可复用的模块。JavaScript 中的模块化方案：

### 9.1 CommonJS

CommonJS 是 Node.js 采用的模块化方案，使用 `require()` 和 `module.exports`。

```javascript
// module.js
const add = (a, b) => a + b;
module.exports = { add };

// main.js
const { add } = require('./module');
console.log(add(2, 3)); // 输出: 5
```

### 9.2 ES 模块

ES 模块是 ES6 引入的模块化方案，使用 `import` 和 `export`。

```javascript
// module.js
export const add = (a, b) => a + b;

// main.js
import { add } from './module.js';
console.log(add(2, 3)); // 输出: 5
```

### 9.3 AMD/CMD

AMD（Asynchronous Module Definition）和 CMD（Common Module Definition）是浏览器端的模块化方案，如 RequireJS 和 SeaJS。

## 10. JavaScript 的最佳实践

### 10.1 代码组织

- 使用严格模式：`'use strict';`
- 保持代码简洁，遵循 DRY（Don't Repeat Yourself）原则
- 使用有意义的变量名和函数名
- 遵循一致的代码风格（如 ESLint、Prettier）
- 使用模块化开发

### 10.2 性能优化

- 减少 DOM 操作
- 使用事件委托
- 避免使用 eval()
- 使用节流和防抖处理频繁触发的事件
- 优化循环和条件语句
- 使用 Web Workers 处理耗时任务

### 10.3 安全性

- 避免使用 `innerHTML`，使用 `textContent` 或 `createElement()`
- 验证用户输入
- 使用 CSP（Content Security Policy）
- 避免暴露敏感信息
- 使用 HTTPS

### 10.4 调试

- 使用浏览器开发者工具（Chrome DevTools、Firefox DevTools）
- 使用 `console.log()`、`console.error()`、`console.warn()` 等
- 使用断点调试
- 使用 `debugger;` 语句
- 使用性能分析工具

## 11. JavaScript 的发展趋势

- **TypeScript**：TypeScript 是 JavaScript 的超集，添加了静态类型检查
- **WebAssembly**：提高 JavaScript 性能，适合计算密集型任务
- **Web Components**：组件化开发，实现跨框架组件复用
- **Progressive Web Apps（PWA）**：提供类似原生应用的体验
- **Serverless JavaScript**：无需管理服务器，专注于代码开发
- **AI/ML in JavaScript**：使用 TensorFlow.js、PyTorch.js 等库进行机器学习

## 12. 总结

JavaScript 是一种功能强大、灵活多样的脚本语言，从最初的网页交互工具发展为全栈开发语言。它具有动态类型、面向对象、函数式编程等特性，支持多种编程范式。

通过学习 JavaScript，你可以：
- 创建动态、交互式的网页
- 开发服务器端应用（Node.js）
- 开发移动应用（React Native、Flutter）
- 开发桌面应用（Electron）
- 探索人工智能和机器学习领域

JavaScript 的学习曲线相对平缓，但要掌握其核心概念（闭包、原型、异步编程等）需要时间和实践。随着 JavaScript 生态的不断发展，它将在更多领域发挥重要作用。

接下来，我们将学习 JavaScript 的语法、DOM 操作、事件处理、异步编程、ES6+ 特性等内容，逐步掌握 JavaScript 的使用方法和最佳实践。